# –ö–≤–∏–∑ –ü–ª–∏–∑ ‚Äî Telegram‚Äë–±–æ—Ç

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –∏–≥—Ä [–ö–≤–∏–∑ –ü–ª–∏–∑](https://quizplease.ru/). –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞, –ø–æ–º–æ–≥–∞–µ—Ç –∫–æ–º–∞–Ω–¥–µ –≥–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞ –¥–∞—Ç—ã, —Ö—Ä–∞–Ω–∏—Ç —Å—Ç–∞—Ç—É—Å—ã (¬´—Å—ã–≥—Ä–∞–Ω–æ¬ª, ¬´–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã¬ª) –∏ –¥–∞–∂–µ –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∞–≤–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —É—á–∞—Å—Ç–∏–µ.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –∏–≥—Ä —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞ –ö–≤–∏–∑ –ü–ª–∏–∑
- **–í—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞** –∏–∑ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∏–ª–∏ —Ä—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏–≥—Ä** –ø–æ –≤—ã–ø—É—Å–∫–∞–º (–ø–∞–∫–µ—Ç–∞–º) —Å –ø–æ–¥—Å—á–µ—Ç–æ–º –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞—Ç

### üó≥Ô∏è –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–æ–≤
- **–û–ø—Ä–æ—Å—ã –ø–æ –ø–∞–∫–µ—Ç–∞–º** - –æ–¥–∏–Ω –æ–ø—Ä–æ—Å –Ω–∞ –∫–∞–∂–¥—ã–π –≤—ã–ø—É—Å–∫ –∏–≥—Ä—ã
- **–û–ø—Ä–æ—Å—ã –ø–æ –¥–∞—Ç–∞–º** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏–≥—Ä –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º (–Ω–µ–¥–µ–ª—è, 2 –Ω–µ–¥–µ–ª–∏, –º–µ—Å—è—Ü)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞ "–ù–µ —Å–º–æ–≥—É –Ω–∏ –≤ –æ–¥–∏–Ω –∏–∑ –¥–Ω–µ–π"

### üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–∞–º–∏
- **–ï–¥–∏–Ω–æ–µ –º–µ–Ω—é —Å—Ç–∞—Ç—É—Å–æ–≤** (`/manage_status`) –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ —Å—ã–≥—Ä–∞–Ω–Ω—ã—Ö –∏–≥—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è–º–∏
- **–°–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–≥—Ä** —Å –∞–¥—Ä–µ—Å–∞–º–∏ –ø–ª–æ—â–∞–¥–æ–∫ –∏ –∏–º–µ–Ω–∞–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–≤—à–∏—Ö —É—á–∞—Å—Ç–∏–µ –≤ –æ–ø—Ä–æ—Å–∞—Ö
- **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Ç–∏–ø–æ–≤** –∏–≥—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–∫—Ä—ã—Ç—å –≤—Å–µ –∫–∞—Ä–∞–æ–∫–µ-–∏–≥—Ä—ã)
- **–õ–µ–≥–µ–Ω–¥–∞ –∏–∫–æ–Ω–æ–∫** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∏–≥—Ä:
  - ‚úÖ - —Å—ã–≥—Ä–∞–Ω–æ
  - üó≥ - –æ–ø—Ä–æ—Å –ø–æ –ø–∞–∫–µ—Ç—É —Å–æ–∑–¥–∞–Ω
  - üìÖ - –æ–ø—Ä–æ—Å –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω

### üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- **–°–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤** (`/game_packs_management`) —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞—Ç, –ª–µ–≥–µ–Ω–¥–æ–π –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Ç–∏–ø–æ–≤
- **–ë—É–¥—É—â–∏–µ –∏–≥—Ä—ã** (`/upcoming`) —Å –≤—ã–±–æ—Ä–æ–º —Ä–µ–∂–∏–º–∞: –ø–æ –ø–∞–∫–µ—Ç–∞–º, –ø–æ –¥–∞—Ç–∞–º –∏–ª–∏ —Ç–æ–ª—å–∫–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤ —Å –∫–Ω–æ–ø–∫–æ–π ¬´–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë¬ª

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Runtime:** Node.js 20
- **Language:** TypeScript 5
- **Bot Framework:** [grammY](https://grammy.dev/)
- **Web Scraping:** Puppeteer + Cheerio
- **Database:** PostgreSQL 16
- **Date/Time:** Day.js —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤
- **Containerization:** Docker + Docker Compose

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose
- Telegram Bot Token ([–ø–æ–ª—É—á–∏—Ç—å –æ—Ç @BotFather](https://t.me/BotFather))
- ID –≤–∞—à–µ–≥–æ Telegram-—á–∞—Ç–∞

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repository-url>
cd KvizPlease_bot
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞:

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```env
# Telegram
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here

# Database
DB_HOST=db
DB_PORT=5432
DB_NAME=quiz
DB_USER=postgres
DB_PASSWORD=your_secure_password

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
DEFAULT_DAYS_AHEAD=30
DEFAULT_DISTRICTS=
MAX_POLL_OPTIONS=10

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
SCHEDULE_CRON=0 10 * * MON
SCHEDULE_TZ=Europe/Moscow
```

### 3. –ó–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö + –±–æ—Ç)
docker compose up -d

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker compose logs -f bot

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
docker compose down
```

### 4. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Telegram

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É `/start`
2. –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ —á–µ—Ä–µ–∑ `/select_city` –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ —Å—Å—ã–ª–∫—É –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ `/set_source <url>`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∫–æ–º–∞–Ω–¥–æ–π `/sync`

## üìñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞ |
| `/help` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ |
| `/select_city` | –í—ã–±—Ä–∞—Ç—å –≥–æ—Ä–æ–¥ –∏–∑ —Å–ø–∏—Å–∫–∞ |
| `/set_source <url>` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤—Ä—É—á–Ω—É—é |
| `/sync` | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä—ã —Å —Å–∞–π—Ç–∞ |
| `/reset` | –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–æ–ª–Ω—É—é –æ—á–∏—Å—Ç–∫—É –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö —á–∞—Ç–∞ |

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/game_packs_management` | –°–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ –∏–≥—Ä —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–∞—Ç, –ª–µ–≥–µ–Ω–¥–æ–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Ç–∏–ø–∞–º–∏ |
| `/upcoming [N]` | –ú–µ–Ω—é –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±–ª–∏–∂–∞–π—à–∏—Ö N –∏–≥—Ä (–ø–æ –ø–∞–∫–µ—Ç–∞–º, –ø–æ –¥–∞—Ç–µ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ) |

### –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–æ–≤

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/polls` | –ú–∞—Å—Ç–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–æ–≤ (–ø–æ —Ç–∏–ø–∞–º, –¥–∞—Ç–∞–º, –ø–∞–∫–µ—Ç–∞–º –∏–ª–∏ —Å—Ä–∞–∑—É –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä) |
| `/register_from_polls` | –ê–Ω–∞–ª–∏–∑ –æ–ø—Ä–æ—Å–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –ø–æ–±–µ–¥–∏–≤—à–∏–µ –∏–≥—Ä—ã |

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–∞–º–∏

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/manage_status` | –ú–µ–Ω—é —Å—Ç–∞—Ç—É—Å–æ–≤: ¬´—Å—ã–≥—Ä–∞–Ω–æ¬ª (–ø–∞–∫–µ—Ç—ã) –∏ ¬´–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã¬ª (–∏–≥—Ä—ã + —É—á–∞—Å—Ç–Ω–∏–∫–∏) |

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ

- `TELEGRAM_BOT_TOKEN` - —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather
- `TELEGRAM_CHAT_ID` - ID —á–∞—Ç–∞, –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- `DB_HOST` - —Ö–æ—Å—Ç PostgreSQL (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `localhost`)
- `DB_PORT` - –ø–æ—Ä—Ç PostgreSQL (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `5432`)
- `DB_NAME` - –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `quiz`)
- `DB_USER` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `postgres`)
- `DB_PASSWORD` - –ø–∞—Ä–æ–ª—å –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `postgres`)

#### –§–∏–ª—å—Ç—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

- `DEFAULT_DAYS_AHEAD` - —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤–ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–≥—Ä—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `30`)
  - –ò–≥—Ä—ã –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —ç—Ç–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –ë–î, –Ω–æ —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è –æ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `DEFAULT_DISTRICTS` - —Ä–∞–π–æ–Ω—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –ø—É—Å—Ç–æ - –≤—Å–µ —Ä–∞–π–æ–Ω—ã)
- `MAX_POLL_OPTIONS` - –º–∞–∫—Å–∏–º—É–º –æ–ø—Ü–∏–π –≤ –æ–ø—Ä–æ—Å–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `10`, –º–∞–∫—Å: `10`)

#### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

- `SCHEDULE_CRON` - —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ cron (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `0 10 * * MON` - –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 10:00)
- `SCHEDULE_TZ` - —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `Europe/Moscow`)

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≥–æ—Ä–æ–¥–∞

–ë–æ—Ç –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –≥–æ—Ä–æ–¥–∞:
- –ú–æ—Å–∫–≤–∞
- –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥
- –ö–∞–∑–∞–Ω—å
- –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥
- –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥
- –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫
- –ò –¥—Ä—É–≥–∏–µ...

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `src/bot/cities.ts`.

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

- **games** - –≤—Å–µ –∏–≥—Ä—ã —Å –¥–µ—Ç–∞–ª—è–º–∏ (–¥–∞—Ç–∞, –º–µ—Å—Ç–æ, —Ü–µ–Ω–∞, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏ —Ç.–¥.)
- **polls** - —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –æ–ø—Ä–æ—Å—ã
- **poll_options** - –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –≤ –æ–ø—Ä–æ—Å–∞—Ö
- **poll_votes** - –≥–æ–ª–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **chat_settings** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–æ–≤ (–∏—Å—Ç–æ—á–Ω–∏–∫, –ø–æ—Å–ª–µ–¥–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
- **chat_played_groups** - –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –∫–∞–∫ —Å—ã–≥—Ä–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
- **chat_excluded_types** - –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã –ø–∞–∫–µ—Ç–æ–≤ (–∏–≥—Ä)
- **excluded_groups** - –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã –ø–∞–∫–µ—Ç–æ–≤ (–∏–≥—Ä)

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ë–î –≤ Docker
docker compose up -d db

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å hot reload)
npm run dev
```

### –°–±–æ—Ä–∫–∞

```bash
# TypeScript ‚Üí JavaScript
npm run build

# –ó–∞–ø—É—Å–∫ —Å–æ–±—Ä–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏
npm start
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
KvizPlease_bot/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ bot/              # –õ–æ–≥–∏–∫–∞ –±–æ—Ç–∞ (–∫–æ–º–∞–Ω–¥—ã, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, UI)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cities.ts     # –°–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ constants.ts  # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è callback-–∫–Ω–æ–ø–æ–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/           # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, –∫–Ω–æ–ø–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ db/               # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pool.ts       # –ü—É–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π PostgreSQL
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repositories.ts # –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ scraper/          # –ü–∞—Ä—Å–∏–Ω–≥ —Å–∞–π—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fetch.ts      # Puppeteer –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parse.ts      # Cheerio –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ normalize.ts  # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gameService.ts    # –†–∞–±–æ—Ç–∞ —Å –∏–≥—Ä–∞–º–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pollService.ts    # –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dateFormatter.ts  # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç (Moscow TZ)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logger.ts         # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ syncQueue.ts      # –û—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ bot.ts            # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.ts         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îÇ   ‚îú‚îÄ‚îÄ index.ts          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îî‚îÄ‚îÄ types.ts          # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ sql/
‚îÇ   ‚îú‚îÄ‚îÄ schema.sql        # –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ upsert_game.sql   # SQL –¥–ª—è upsert –∏–≥—Ä
‚îú‚îÄ‚îÄ docker-compose.yml    # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile            # Dockerfile –¥–ª—è –±–æ—Ç–∞
‚îî‚îÄ‚îÄ package.json          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω: `docker compose ps`
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏: `docker compose logs -f bot`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `TELEGRAM_CHAT_ID`

### –ù–µ–≤–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –∏–≥—Ä

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ—Å–∫–æ–≤—Å–∫–∏–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å (`Europe/Moscow`). –ï—Å–ª–∏ –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–µ–≤–µ—Ä–Ω–æ, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
- –î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ Puppeteer –Ω–∞ –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞

### –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–≥—Ä

–ï—Å–ª–∏ `/sync` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–æ–ª—å—à–µ –∏–≥—Ä, —á–µ–º `/game_packs_management`:
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–≥—Ä—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ `DEFAULT_DAYS_AHEAD` (30 –¥–Ω–µ–π)
- –ò–≥—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã –ø–æ —Ä–∞–π–æ–Ω–∞–º
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã –ø–∞–∫–µ—Ç–æ–≤ (–∏–≥—Ä) —á–µ—Ä–µ–∑ `/remove_game_types`


## ü§ù –í–∫–ª–∞–¥

–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ pull requests –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

---

**–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –ö–≤–∏–∑ –ü–ª–∏–∑**
